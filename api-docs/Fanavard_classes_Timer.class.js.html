<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Fanavard/classes/Timer.class.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Charblock.html">Charblock</a><ul class='methods'><li data-type='method'><a href="Charblock.html#.destroy">destroy</a></li><li data-type='method'><a href="Charblock.html#.factory">factory</a></li><li data-type='method'><a href="Charblock.html#.getNew">getNew</a></li><li data-type='method'><a href="Charblock.html#.move">move</a></li><li data-type='method'><a href="Charblock.html#.showUpComingChar">showUpComingChar</a></li></ul></li><li><a href="Interval.html">Interval</a><ul class='methods'><li data-type='method'><a href="Interval.html#clear">clear</a></li><li data-type='method'><a href="Interval.html#clearAll">clearAll</a></li><li data-type='method'><a href="Interval.html#make">make</a></li></ul></li><li><a href="MaterialColor.html">MaterialColor</a><ul class='methods'><li data-type='method'><a href="MaterialColor.html#.getRandomColor">getRandomColor</a></li><li data-type='method'><a href="MaterialColor.html#.pickRandomProperty">pickRandomProperty</a></li></ul></li><li><a href="Matrix.html">Matrix</a><ul class='methods'><li data-type='method'><a href="Matrix.html#_deleteCharacters">_deleteCharacters</a></li><li data-type='method'><a href="Matrix.html#_getRailingChars">_getRailingChars</a></li><li data-type='method'><a href="Matrix.html#checkWords">checkWords</a></li><li data-type='method'><a href="Matrix.html#setCharacter">setCharacter</a></li></ul></li><li><a href="Modal.html">Modal</a><ul class='methods'><li data-type='method'><a href="Modal.html#createContent">createContent</a></li><li data-type='method'><a href="Modal.html#createFooter">createFooter</a></li><li data-type='method'><a href="Modal.html#createHeader">createHeader</a></li><li data-type='method'><a href="Modal.html#destroy">destroy</a></li><li data-type='method'><a href="Modal.html#show">show</a></li></ul></li><li><a href="Sound.html">Sound</a><ul class='methods'><li data-type='method'><a href="Sound.html#.getInstance">getInstance</a></li><li data-type='method'><a href="Sound.html#.makeInstanceName">makeInstanceName</a></li><li data-type='method'><a href="Sound.html#.playByKey">playByKey</a></li><li data-type='method'><a href="Sound.html#.setInstance">setInstance</a></li><li data-type='method'><a href="Sound.html#pause">pause</a></li><li data-type='method'><a href="Sound.html#play">play</a></li></ul></li><li><a href="Storage.html">Storage</a><ul class='methods'><li data-type='method'><a href="Storage.html#.get">get</a></li><li data-type='method'><a href="Storage.html#.getInt">getInt</a></li><li data-type='method'><a href="Storage.html#.getJson">getJson</a></li><li data-type='method'><a href="Storage.html#.set">set</a></li></ul></li><li><a href="Swipe.html">Swipe</a><ul class='methods'><li data-type='method'><a href="Swipe.html#buildListeners">buildListeners</a></li><li data-type='method'><a href="Swipe.html#destroy">destroy</a></li><li data-type='method'><a href="Swipe.html#onTouchEnd">onTouchEnd</a></li><li data-type='method'><a href="Swipe.html#onTouchStart">onTouchStart</a></li><li data-type='method'><a href="Swipe.html#whileTouch">whileTouch</a></li></ul></li><li><a href="TetrisGame.html">TetrisGame</a><ul class='methods'><li data-type='method'><a href="TetrisGame.html#.build">build</a></li><li data-type='method'><a href="TetrisGame.html#.checkWordSuccess">checkWordSuccess</a></li><li data-type='method'><a href="TetrisGame.html#.getValidColumnsNumber">getValidColumnsNumber</a></li></ul></li><li><a href="Timer.html">Timer</a><ul class='methods'><li data-type='method'><a href="Timer.html#pause">pause</a></li><li data-type='method'><a href="Timer.html#resume">resume</a></li><li data-type='method'><a href="Timer.html#start">start</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#addLanguage">addLanguage</a></li><li><a href="global.html#allowedInitTypes">allowedInitTypes</a></li><li><a href="global.html#allowInit">allowInit</a></li><li><a href="global.html#arshLoader">arshLoader</a></li><li><a href="global.html#build">build</a></li><li><a href="global.html#buildDummy">buildDummy</a></li><li><a href="global.html#buildPlugIns">buildPlugIns</a></li><li><a href="global.html#checkLoad">checkLoad</a></li><li><a href="global.html#debugMode">debugMode</a></li><li><a href="global.html#deepExtend">deepExtend</a></li><li><a href="global.html#defaultLoadProperties">defaultLoadProperties</a></li><li><a href="global.html#defaultType">defaultType</a></li><li><a href="global.html#deleteNode">deleteNode</a></li><li><a href="global.html#disableCache">disableCache</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#jRun">jRun</a></li><li><a href="global.html#loadedFiles">loadedFiles</a></li><li><a href="global.html#notAllowedUserAttributes">notAllowedUserAttributes</a></li><li><a href="global.html#plugins">plugins</a></li><li><a href="global.html#reverse">reverse</a></li><li><a href="global.html#sanitizeName">sanitizeName</a></li><li><a href="global.html#setLoadedFlag">setLoadedFlag</a></li><li><a href="global.html#TetrisWords">TetrisWords</a></li><li><a href="global.html#urlPrefix">urlPrefix</a></li><li><a href="global.html#version">version</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Fanavard/classes/Timer.class.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 @typedef {Object} TimerConfig
 @property {string} [cssClass=".timerDisplay"] - CssClass selecor for setting time in timerDisplay.
 @property {function}   onStart     - Event when timer get's started.
 @property {function}   onPause     - Event when timer get's paused.
 @property {function}   onResume    - Event when timer get's resumed.
 @property {Object}     blobTiming  - Blob for feeding WebWorker.
 @property {function}   workerOnMessage(event) - Callback function for WebWorker.onmessage .
 @property {function}   beatifySecond(seconds) - Function to make time beatiful.
 */

/**
 * @class
 * A class which use WebWorker to manage time.
 * @constructor
 * @param {TimerConfig}
 *
 * @property timerWorker {WebWorker} WebWorker used in timer
 * @property config {TimerConfig}
 *
 *
 * @example
*    let timer = new Timer({
*        onStart: function(){
*            TetrisGame.initValues.paused = false;
*        },
*        workerOnMessage:function (event) {
*            Storage.set('seconds', event.data);
*        },
*        onPause:function () {
*            TetrisGame.initValues.paused = true;
*        },
*        onResume:function () {
*            TetrisGame.initValues.paused = false;
*        },
*        blobTiming: new Blob([document.querySelector('#workerTiming').textContent], { type: "text/javascript" });,
*    });
 */
class Timer {

    /**
     * Create instance for timing
     * @param config
     */
    constructor(config) {
        this.timerWorker = null;
        //Default config
        let defaultConfig = {
            cssClsss: ".timerDisplay",
            onStart: () => { },
            onPause: () => { },
            onResume: () => { },
            blobTiming: '',
            workerOnMessage: (event) => { },
            beautifySecond: (s) => {
                if (s > 3600) {
                    // 1 hour and 34 min
                    return (Math.ceil(s / 3600) + lang.hour + lang.and + s % 3600 + lang.min);
                } else if (s > 60 &amp;&amp; s &lt;= 3600) {
                    // 4 min and 3 s
                    return (Math.ceil(s / 60) + lang.minute + lang.and + s % 60 + lang.second);
                } else {
                    return (s + lang.second);
                }
            }
        };

        //Extend config
        this.config = Object.assign(defaultConfig, config);
    }


    /**
     * Starts the timer
     */
    start() {
        let timerDisplayEl = document.querySelector(this.config.cssClsss);
        if (typeof (Worker) !== "undefined") {
            if (!this.timerWorker) {
                this.timerWorker = new Worker(window.URL.createObjectURL(this.config.blobTiming));
            } else {
                // stop timer if running already
                this.pause();
            }

            this.timerWorker.onmessage = (event) => {
                timerDisplayEl.innerHTML = this.config.beautifySecond(event.data);
                this.config.workerOnMessage(event);
            }
            this.config.onStart();
        } else {
            timerDisplayEl.innerHTML = lang.webWorkerNotSupported;
        }
    }

    /**
     * Pauses the timer
     */
    pause() {
        if(this.timerWorker) {
            this.timerWorker.postMessage({'pause_flag': true});
        }
        this.config.onPause();

    }


    /**
     * Resumes the timer
     */
    resume() {
        if(this.timerWorker) {
            this.timerWorker.postMessage({'pause_flag': false});
        }
        this.config.onResume();
    }

}

</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jul 10 2018 02:24:37 GMT+0430 (+0430) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
